(this.webpackJsonpmesto=this.webpackJsonpmesto||[]).push([[0],[,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/close_button.5df32a06.svg"},function(e,t,a){e.exports=a.p+"static/media/not_found.908c20cb.svg"},,,,,,,,,,,function(e,t,a){},,function(e,t,a){e.exports=a.p+"static/media/logo.c6f11019.svg"},,function(e,t,a){e.exports=a.p+"static/media/good_registration.e38b395c.svg"},function(e,t,a){e.exports=a.p+"static/media/bad_registration.4072126c.svg"},function(e,t,a){e.exports=a.p+"static/media/delete_button.d8078343.svg"},function(e,t,a){e.exports=a.p+"static/media/pen.d476a8b8.svg"},function(e,t,a){e.exports=a.p+"static/media/edit__button.b05083e5.svg"},function(e,t,a){e.exports=a.p+"static/media/add__button.b2fce4ac.svg"},function(e,t,a){e.exports=a.p+"static/media/\u0433\u043e\u0440\u0430_\u044d\u043b\u044c\u0431\u0440\u0443\u0441.d6ed7639.jpg"},,,function(e,t,a){e.exports=a(48)},,,,,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(26),i=a.n(r),s=a(11),c=a(36),l=a(1),p=a(2),u=a(10),d=a(4),m=a(3),h=a(5),f=new(function(){function e(t){Object(l.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(p.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}},{key:"_get",value:function(e){return fetch("".concat(this._baseUrl,"/").concat(e),{headers:{authorization:this._headers.authorization}}).then(this._getResponseData)}},{key:"getUserInfo",value:function(){return this._get("users/me")}},{key:"getInitialCards",value:function(){return this._get("cards")}},{key:"updateUserInfo",value:function(e,t){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._getResponseData)}},{key:"addNewCard",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._getResponseData)}},{key:"_updateCardLike",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:t,headers:{authorization:this._headers.authorization}}).then(this._getResponseData)}},{key:"likeCard",value:function(e){return this._updateCardLike(e,"PUT")}},{key:"dislikeCard",value:function(e){return this._updateCardLike(e,"DELETE")}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._headers.authorization}}).then(this._getResponseData)}},{key:"updateUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._getResponseData)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12",headers:{authorization:"f4b731d6-2118-4fcc-9305-6dde1beafd26","Content-Type":"application/json"}}),_=a(19),g=a(27),b=a.n(g),E=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("header",{className:"header"},o.a.createElement("a",{href:"http://"},o.a.createElement("img",{src:b.a,className:"header__logo",alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f Mesto"})),o.a.createElement("div",{className:"header__menu-container"},o.a.createElement("p",{className:"header__user"},this.props.userEmail),o.a.createElement(s.b,{to:this.props.link,onClick:this.props.handleLogout,className:"header__menu"},this.props.title)))}}]),a}(o.a.Component),v=Object(h.g)(E),C=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("section",{className:"login"},o.a.createElement("form",{name:"popup-".concat(this.props.name,"-form"),method:"get",action:"#",className:"login__form",noValidate:!0,onSubmit:this.props.onSubmit},o.a.createElement("h2",{className:"login__title"},this.props.title),o.a.createElement("input",{id:"username-input",name:"username",type:"text",required:!0,minLength:"2",maxLength:"40",placeholder:"Email",className:"login__input",onChange:this.props.onChange}),o.a.createElement("input",{id:"prassword-input",name:"password",type:"password",required:!0,minLength:"2",maxLength:"200",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"login__input",onChange:this.props.onChange}),o.a.createElement("button",{type:"submit",className:" login__submit-button"},this.props.buttonName),this.props.children))}}]),a}(o.a.Component),k=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={username:"",password:"",isOpen:!0},n.handleChange=n.handleChange.bind(Object(u.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(u.a)(n)),n}return Object(p.a)(a,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(_.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.authorize(this.state.username,this.state.password).then((function(e){e.token&&t.setState({username:"",password:""},(function(){t.props.handleLogin()}))})).catch((function(e){return console.log(e)}))}},{key:"onCloseSignInPopup",value:function(){this.props.onClose(),this.setState={username:"",password:""}}},{key:"render",value:function(){return o.a.createElement("div",{className:"page"},o.a.createElement(v,{link:"/signup",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),o.a.createElement(C,{name:"login",title:"\u0412\u0445\u043e\u0434",buttonName:"\u0412\u043e\u0439\u0442\u0438",onChange:this.handleChange,onSubmit:this.handleSubmit},o.a.createElement("div",{className:"login__footer"},o.a.createElement("p",{className:"login__footer-title"},"\u0415\u0449\u0451 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"),o.a.createElement(s.b,{to:"/signup",className:"login__footer-link"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"))))}}]),a}(o.a.Component),O=Object(h.g)(k),N=a(13),y=a.n(N),P=a(29),j=a.n(P),S=a(30),A=a.n(S),U=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("section",{className:"popup ".concat(this.props.isOpen?"popup_opened":"")},o.a.createElement("div",{className:"popup__container form popup__registration-form"},o.a.createElement("img",{src:this.props.registered?j.a:A.a,alt:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",className:"popup__registration-image"}),o.a.createElement("h2",{className:"popup__title popup__registration-title"},this.props.title),o.a.createElement("button",{"aria-label":"close",type:"button",className:"popup__close-button",onClick:this.props.onClose},o.a.createElement("img",{src:y.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close-button-image"}))))}}]),a}(o.a.Component),x=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleChange=function(e){var t=e.target,a=t.name,o=t.value;n.setState(Object(_.a)({},a,o))},n.handleSubmit=function(e){e.preventDefault(),n.props.register(n.state.username,n.state.password).then((function(e){n.handleGoodRegistration()})).catch((function(e){console.log("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430."),n.handleBadRegistration()}))},n.handleClose=function(){n.setState({isRegistrationPopupOpen:!1},(function(){n.props.history.push("/signin")}))},n.handleGoodRegistration=function(){n.setState({isRegistrationPopupOpen:!0,infoTooltipTitle:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",infoTooltipRegistered:!0})},n.handleBadRegistration=function(){n.setState({isRegistrationPopupOpen:!0,infoTooltipTitle:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",infoTooltipRegistered:!1})},n.state={username:"",password:"",isRegistrationPopupOpen:!1,infoTooltipTitle:null,infoTooltipRegistered:!1},n.handleChange=n.handleChange.bind(Object(u.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(u.a)(n)),n}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"page"},o.a.createElement(v,{link:"/signin",title:"\u0412\u043e\u0439\u0442\u0438"}),o.a.createElement(C,{name:"login",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonName:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",onChange:this.handleChange,onSubmit:this.handleSubmit},o.a.createElement("div",{className:"login__footer"},o.a.createElement("p",{className:"login__footer-title"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"),o.a.createElement(s.b,{to:"/signin",className:"login__footer-link"},"\u0412\u043e\u0439\u0442\u0438"))),o.a.createElement(U,{title:this.state.infoTooltipTitle,isOpen:this.state.isRegistrationPopupOpen,registered:this.state.infoTooltipRegistered,onClose:this.handleClose}))}}]),a}(o.a.Component),L=Object(h.g)(x),I=a(37),D=function(e){var t=e.component,a=Object(I.a)(e,["component"]);return o.a.createElement(h.b,null,(function(){return a.loggedIn?o.a.createElement(t,a):o.a.createElement(h.a,{to:"/signin"})}))},T=a(31),w=a.n(T),R=a(14),z=a.n(R),q=o.a.createContext(),J=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).onImageNotFound=function(e){e.target.onerror=null,e.target.src=z.a},e.onCardClick=function(){e.props.onCardClick(e.props.card)},e.handleLikeClick=function(){e.props.onCardLike(e.props.card)},e.handleDeleteClick=function(){e.props.onCardDelete(e.props.card)},e}return Object(p.a)(a,[{key:"render",value:function(){var e=this,t=this.props.card.owner._id===this.context._id,a=this.props.card.likes.find((function(t){return t._id===e.context._id}));return o.a.createElement("div",{className:"elements__item",key:this.props.card._id},o.a.createElement("img",{onError:this.onImageNotFound,onClick:this.onCardClick,className:"elements__item-picture",alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430",src:this.props.card.link}),o.a.createElement("div",{className:"elements__item-info"},o.a.createElement("h2",{className:"elements__item-title"},this.props.card.name),o.a.createElement("div",{className:"elements__likes-container"},o.a.createElement("button",{"aria-label":"like",type:"button",onClick:this.handleLikeClick,className:"elements__heart-button  ".concat(a?"elements__heart-button_active":"","  ")}),o.a.createElement("p",{className:"elements__likes"},this.props.card.likes?this.props.card.likes.length:0))),o.a.createElement("button",{"aria-label":"delete",type:"button",onClick:this.handleDeleteClick,className:"elements__delete-button ".concat(t?"":"elements__delete-button_inactive")},o.a.createElement("img",{src:w.a,alt:"\u0417\u043d\u0430\u043a \u043a\u043e\u0440\u0437\u0438\u043d\u044b"})))}}]),a}(o.a.Component);J.contextType=q;var F=J,B=a(32),M=a.n(B),G=a(33),H=a.n(G),V=a(34),Z=a.n(V),$=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).onImageNotFound=function(e){e.target.onerror=null,e.target.src=z.a},e}return Object(p.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__avatar"},o.a.createElement("img",{src:M.a,className:"profile_active",alt:" \u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0438"}),o.a.createElement("img",{src:this.context&&this.context.avatar,onError:this.onImageNotFound,onClick:this.props.onEditAvatar,className:"profile__image",alt:"\u0410\u0432\u0430\u0442\u0430\u0440"})),o.a.createElement("div",null,o.a.createElement("div",{className:"profile__name-container"},o.a.createElement("h1",{className:"profile__name"},this.context&&this.context.name),o.a.createElement("button",{"aria-label":"edit",type:"button",onClick:this.props.onEditProfile,className:"profile__edit-button"},o.a.createElement("img",{src:H.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f"}))),o.a.createElement("p",{className:"profile__profession"},this.context&&this.context.about))),o.a.createElement("button",{"aria-label":"add",type:"button",onClick:this.props.onAddPlace,className:"profile__add-button"},o.a.createElement("img",{src:Z.a,className:"profile__add-button-image",alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f"}))),o.a.createElement("section",{className:"elements"},this.props.cards.map((function(t){return o.a.createElement(F,{card:t,currentUserId:e.context&&e.context._id,key:t._id,onCardClick:e.props.onCardClick,onCardLike:e.props.onCardLike,onCardDelete:e.props.onCardDelete})}))))}}]),a}(o.a.Component);$.contextType=q;var K=$;var Q=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__info"},"\xa9 2020. Mesto Russia"))},W=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("section",{className:"popup popup_".concat(this.props.name," ").concat(this.props.isOpen?"popup_opened":"")},o.a.createElement("form",{name:"popup-".concat(this.props.name,"-form"),method:"get",action:"#",className:"popup__container form",noValidate:!0,onSubmit:this.props.onSubmit},o.a.createElement("h2",{className:"popup__title"},this.props.title),this.props.children,o.a.createElement("button",{type:"submit",className:"popup__button form__submit ".concat(this.props.isSubmitActive?"":"form__submit_inactive")},this.props.buttonName),o.a.createElement("button",{"aria-label":"close",type:"button",className:"popup__close-button",onClick:this.props.onClose},o.a.createElement("img",{src:y.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close-button-image"}))))}}]),a}(o.a.Component),X=a(15);var Y=function(e){var t=o.a.useContext(q),a=o.a.useState(""),n=Object(X.a)(a,2),r=n[0],i=n[1],s=o.a.useState(""),c=Object(X.a)(s,2),l=c[0],p=c[1];return o.a.useEffect((function(){i(t.name),p(t.about)}),[t]),o.a.createElement(W,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isSubmitActive:!0,isOpen:e.isOpen,onClose:function(){e.onClose(),i(t.name),p(t.about)},onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:l})}},o.a.createElement("input",{id:"name-input",type:"text",required:!0,minLength:"2",maxLength:"40",pattern:"[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s\\-]+$",placeholder:"\u0418\u043c\u044f",className:"popup__text popup__text_type_name form__input",onChange:function(e){i(e.target.value)},value:r}),o.a.createElement("span",{id:"name-input-error",className:"form__input-error"}),o.a.createElement("input",{id:"profession-input",type:"text",required:!0,minLength:"2",maxLength:"200",pattern:"[A-Za-z\u0410-\u042f\u0430-\u044f\u0401\u0451\\s\\-,]+$",placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"popup__text popup__text_type_profession form__input",onChange:function(e){p(e.target.value)},value:l}),o.a.createElement("span",{id:"profession-input-error",className:"form__input-error"}))};var ee=function(e){var t=o.a.useRef();return o.a.createElement(W,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isSubmitActive:!0,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})}},o.a.createElement("input",{id:"url-input",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",className:"popup__text popup__text_type_link form__input",ref:t}),o.a.createElement("span",{id:"url-input-error",className:"form__input-error"}))};var te=function(e){var t=o.a.useState(""),a=Object(X.a)(t,2),n=a[0],r=a[1],i=o.a.useState(""),s=Object(X.a)(i,2),c=s[0],l=s[1];return o.a.createElement(W,{name:"card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isSubmitActive:!0,isOpen:e.isOpen,onClose:function(){e.onClose(),r(""),l("")},onSubmit:function(t){t.preventDefault(),e.onUpdatePlace(n,c)}},o.a.createElement("input",{id:"picture-input",type:"text",required:!0,minLength:"1",maxLength:"30",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__text popup__text_type_picture form__input",onChange:function(e){r(e.target.value)}}),o.a.createElement("span",{id:"picture-input-error",className:"form__input-error"}),o.a.createElement("input",{id:"url-input",type:"url",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__text popup__text_type_link form__input",onChange:function(e){l(e.target.value)}}),o.a.createElement("span",{id:"url-input-error",className:"form__input-error"}))},ae=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).onImageNotFound=function(e){e.target.onerror=null,e.target.src=z.a},e}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("section",{className:"popup popup_picture ".concat(this.props.card?"popup_opened":"")},o.a.createElement("div",{className:"popup__container popup__container_picture"},o.a.createElement("img",{src:null!==this.props.card?this.props.card.link:"",onError:this.onImageNotFound,alt:"\u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430",className:"popup__image"}),o.a.createElement("h2",{className:"popup__title popup__title_picture"},null!==this.props.card?this.props.card.name:""),o.a.createElement("button",{"aria-label":"close",type:"button",className:"popup__close-button",onClick:this.props.onClose},o.a.createElement("img",{src:y.a,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close-button-image"}))))}}]),a}(o.a.Component),ne=(a(25),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"page"},o.a.createElement(q.Provider,{value:this.props.currentUser},o.a.createElement(v,{link:"/signin",userEmail:this.props.userEmail,handleLogout:this.props.handleLogout,title:"\u0412\u044b\u0439\u0442\u0438"}),o.a.createElement(K,{onEditAvatar:this.props.handleEditAvatarClick,onEditProfile:this.props.handleEditProfileClick,onAddPlace:this.props.handleAddPlaceClick,onCardClick:this.props.handleCardClick,cards:this.props.cards,onCardLike:this.props.handleCardLike,onCardDelete:this.props.handleCardDelete}),o.a.createElement(ae,{card:this.props.selectedCard,onClose:this.props.closeAllPopups}),o.a.createElement(Y,{onUpdateUser:this.props.handleUpdateUser,isOpen:this.props.isEditProfilePopupOpen,onClose:this.props.closeAllPopups}),o.a.createElement(te,{onUpdatePlace:this.props.handleAddPlaceSubmit,isOpen:this.props.isAddPlacePopupOpen,onClose:this.props.closeAllPopups}),o.a.createElement(W,{name:"check",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonName:"\u0414\u0430",isSubmitActive:!0,isOpen:!1,onClose:this.props.closeAllPopups}),o.a.createElement(ee,{onUpdateAvatar:this.props.handleUpdateAvatar,isOpen:this.props.isEditAvatarPopupOpen,onClose:this.props.closeAllPopups})),o.a.createElement(Q,null))}}]),a}(o.a.Component));ne.contextType=q;var oe=ne,re=a(7),ie=Object(re.a)(),se=a(35),ce=a.n(se),le="https://auth.nomoreparties.co";function pe(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}var ue=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).getInitialCards=function(){return f.getInitialCards().then((function(t){e.setState({cards:t})})).catch((function(e){console.log(e)}))},e.getUserInfo=function(){return f.getUserInfo().then((function(t){e.setState({currentUser:t})})).catch((function(t){e.setState({currentUser:e.createDefaultUser()}),console.log(t)}))},e.handleLogin=function(){e.setState({loggedIn:!0},(function(){e.handleTokenCheck()}))},e.handleLogout=function(){localStorage.removeItem("jwt"),e.setState({loggedIn:!1,UserData:{email:"email"}})},e.authorize=function(e,t){return function(e,t){return fetch("".concat(le,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return pe(e)})).then((function(e){return localStorage.setItem("jwt",e.token),e}))}(e,t)},e.register=function(e,t){return function(e,t){return fetch("".concat(le,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return pe(e)}))}(e,t)},e.handleCardLike=function(t){console.log(t),(t.likes.find((function(t){return t._id===e.state.currentUser._id}))?f.dislikeCard(t._id):f.likeCard(t._id)).then((function(a){var n=e.state.cards.map((function(e){return e._id===t._id?a:e}));e.setState({cards:n})}))},e.handleCardDelete=function(t){f.deleteCard(t._id).then((function(){var a=e.state.cards.filter((function(e){return e._id!==t._id}));e.setState({cards:a})})).catch((function(e){console.log(e)}))},e.handleAddPlaceSubmit=function(t,a){f.addNewCard(t,a).then((function(t){console.log(t),e.setState({cards:[].concat(Object(c.a)(e.state.cards),[t])})})).then((function(){e.closeAllPopups()})).catch((function(e){console.log(e)}))},e.handleUpdateUser=function(t){var a=t.name,n=t.about;f.updateUserInfo(a,n).then((function(t){e.setState({currentUser:t})})).then((function(){e.closeAllPopups()})).catch((function(t){e.setState({currentUser:e.createDefaultUser()}),console.log(t)}))},e.handleUpdateAvatar=function(t){var a=t.avatar;f.updateUserAvatar(a).then((function(t){e.setState({currentUser:t})})).then((function(){e.closeAllPopups()})).catch((function(t){e.setState({currentUser:e.createDefaultUser()}),console.log(t)}))},e.handleEditAvatarClick=function(){e.setState({isEditAvatarPopupOpen:!0})},e.handleEditProfileClick=function(){e.setState({isEditProfilePopupOpen:!0})},e.handleAddPlaceClick=function(){e.setState({isAddPlacePopupOpen:!0})},e.handleAddPlaceClick=function(){e.setState({isAddPlacePopupOpen:!0})},e.handleCardClick=function(t){e.setState({selectedCard:t})},e.closeAllPopups=function(){e.setState({isEditProfilePopupOpen:!1,isAddPlacePopupOpen:!1,isEditAvatarPopupOpen:!1,selectedCard:null})},e.createDefaultUser=function(){return{_id:-1,name:"No name",about:"No description",avatar:ce.a}},e.render=function(){return o.a.createElement(h.c,{history:ie},o.a.createElement("main",{className:"content"},o.a.createElement(h.d,null,o.a.createElement(D,{path:"/myprofile",currentUser:e.state.currentUser,loggedIn:e.state.loggedIn,userEmail:e.state.UserData.email,handleLogout:e.handleLogout,handleEditAvatarClick:e.handleEditAvatarClick,handleEditProfileClick:e.handleEditProfileClick,handleAddPlaceClick:e.handleAddPlaceClick,handleCardClick:e.handleCardClick,cards:e.state.cards,handleCardLike:e.handleCardLike,handleCardDelete:e.handleCardDelete,selectedCard:e.state.selectedCard,closeAllPopups:e.closeAllPopups,handleUpdateUser:e.handleUpdateUser,isEditProfilePopupOpen:e.state.isEditProfilePopupOpen,handleAddPlaceSubmit:e.handleAddPlaceSubmit,isAddPlacePopupOpen:e.state.isAddPlacePopupOpen,onUpdateAvatar:e.handleUpdateAvatar,isEditAvatarPopupOpen:e.state.isEditAvatarPopupOpen,getInitialCards:e.getInitialCards,getUserInfo:e.getUserInfo,component:oe}),o.a.createElement(h.b,{path:"/tips",loggedIn:e.state.loggedIn,component:U}),o.a.createElement(h.b,{path:"/signup"},o.a.createElement(L,{register:e.register})),o.a.createElement(h.b,{path:"/signin"},o.a.createElement(O,{handleLogin:e.handleLogin,authorize:e.authorize,onClose:e.closeAllPopups})),o.a.createElement(h.b,{path:"*"},e.state.loggedIn?o.a.createElement(h.a,{to:"/myprofile"}):o.a.createElement(h.a,{to:"/signin"})))))},e.state={loggedIn:!1,UserData:{email:"email"},isEditProfilePopupOpen:!1,isAddPlacePopupOpen:!1,isEditAvatarPopupOpen:!1,selectedCard:null,currentUser:e.createDefaultUser(),cards:[]},e.handleLogin=e.handleLogin.bind(Object(u.a)(e)),e.handleTokenCheck=e.handleTokenCheck.bind(Object(u.a)(e)),e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.handleTokenCheck()}},{key:"handleTokenCheck",value:function(){var e,t=this,a=localStorage.getItem("jwt");a&&(e=a,fetch("".concat(le,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return pe(e)})).catch((function(e){return console.log(e)}))).then((function(e){e&&t.setState({loggedIn:!0,UserData:{email:e.data.email}},(function(){ie.push("/myprofile"),t.getUserInfo(),t.getInitialCards()}))}))}}]),a}(o.a.Component),de=Object(h.g)(ue);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s.a,null,o.a.createElement(de,null))),document.getElementById("root"))}],[[38,1,2]]]);
//# sourceMappingURL=main.473c76b4.chunk.js.map